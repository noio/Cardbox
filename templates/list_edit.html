{% extends "base.html" %}

{% load cardbox_filters %}


{% block content %}
    <div class="span-24">
        {% if list.is_saved %}
        <form id='list-edit-form' action="{% url cardbox.views.list_edit name=list.name %}" method="post">
        <div class='page-head'>
            <span class='item-icon list'></span>
            <h3></span><span class='faded'>Editing list: </span></h3> <input class='title' name='title' type='text' value='{{list.title}}'>
        {% else %}
        <form id='list-edit-form' action="{% url cardbox.views.list_create %}" method="post">
        <div class='page-head'>
            <span class='item-icon list'></span>
            <h3><span class='faded'>Creating a list named: </span></h3> <input class='title' name='title' type='text' value='{{page.title}}'>
        {% endif %}
            <div class='button-bar standalone'><ul>
                {% if page.is_saved %}<li><a class='button-cancel' href='{% url cardbox.views.list_view name=page.name %}'><span class='icon'></span>Cancel</a></li>{%endif%}
                <li><a class='button-save' href='#' onClick='$("page-edit-form").submit()'><span class='icon'></span>Save Changes</a></li>
            </ul></div>
        </div>
        </form>
        <form>
        <table id='list-editor' class='list-view'>
            <thead>
                <tr>
                    {% for k in list.columns %}
                    <th>{{k}}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
            {% for row_id in list.row_order %}
            {% with list.rows|dictkey:row_id as row %}
            <tr class='{% cycle "table-tr-odd" " "%}'>
                {% for c in list.columns %}
                <td>{{row|dictkey:c}}</td>
                {% endfor %}
            </tr>
            {% endwith %}
            {% endfor %}
            </tbody>
        </table>
        <script type='text/javascript'>
            window.listEditor = new ListEditor('list-editor');
        </script>
        </form>
    </div>
{% endblock %}